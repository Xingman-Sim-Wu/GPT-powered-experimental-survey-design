/* ===== GPT-like chat layout & bubbles ===== */
:root {
    --bg: #f6f7f9;
    --panel: #ffffff;
    --border: #e6e8eb;
    --text: #0b0f13;
    --muted: #64748b;
    --assistant: #f2f4f7;
    --assistant-border: #d9dee3;
    --user: #0ea5e9;
    --user-text: #ffffff;
  }
  
  /* Page */
  html, body {
    height: 100%;
  }
  body {
    margin: 0;
    background: var(--bg);
    color: var(--text);
    font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
  }
  
  /* Container similar to ChatGPT: full-height column, sticky composer */
  #chat-container {
    height: 100dvh; /* supports mobile */
    max-width: 900px;
    margin: 0 auto;
    display: flex;
    flex-direction: column;
  }
  
  /* Messages panel */
  #history, /* our JS history div */
  #chatbox /* backward compat if your HTML uses this id */ {
    flex: 1 1 auto;
    overflow-y: auto;
    padding: 24px 16px 32px;
    scroll-behavior: smooth;
  }
  
  /* Subtle scrollbar */
  #history::-webkit-scrollbar { width: 10px; }
  #history::-webkit-scrollbar-thumb { background: #c9cfd6; border-radius: 8px; }
  #history::-webkit-scrollbar-track { background: transparent; }
  
  /* Each row (one bubble with optional avatar) */
  .chat-row {
    display: flex;
    gap: 10px;
    margin: 10px 0;
    align-items: flex-end;
  }
  .chat-row.assistant { justify-content: flex-start; }
  .chat-row.user { justify-content: flex-end; }
  
  /* Optional avatar circle */
  .chat-avatar {
    flex: 0 0 28px;
    width: 28px; height: 28px;
    border-radius: 50%;
    display: grid; place-items: center;
    font-size: 14px; font-weight: 600;
    background: #111827; color: #fff; /* assistant dark */
  }
  .chat-row.user .chat-avatar {
    background: var(--user);
  }
  
  /* Bubble */
  .chat-bubble {
    position: relative;
    max-width: min(78%, 680px);
    padding: 12px 14px;
    border-radius: 16px;
    line-height: 1.45;
    font-size: 15px;
    box-shadow: 0 1px 0 rgba(0,0,0,0.03);
    word-wrap: break-word;
    white-space: pre-wrap;
  }
  .chat-row.assistant .chat-bubble {
    background: var(--assistant);
    border: 1px solid var(--assistant-border);
  }
  .chat-row.user .chat-bubble {
    background: var(--user);
    color: var(--user-text);
    border: 1px solid rgba(255,255,255,0.2);
  }
  
  /* Tiny tail (subtle) */
  .chat-row.assistant .chat-bubble:after,
  .chat-row.user .chat-bubble:after {
    content: "";
    position: absolute;
    bottom: 0; width: 10px; height: 10px;
    background: inherit; border: inherit;
    transform: translateY(50%) rotate(45deg);
  }
  .chat-row.assistant .chat-bubble:after { left: -5px; border-right: none; border-top: none; }
  .chat-row.user .chat-bubble:after { right: -5px; border-left: none; border-top: none; }
  
  /* Role label (optional, minimal) */
  .chat-role {
    display: none; /* hide to look closer to GPT UI */
    font-size: 12px; color: var(--muted); margin: 0 6px;
  }
  
  /* Meta row under a bubble (timestamp, tokens, etc.) */
  .chat-meta {
    font-size: 12px;
    color: var(--muted);
    margin-top: 6px;
  }
  .chat-row.user .chat-meta { text-align: right; }
  
  /* Composer area */
  #composer {
    position: sticky;
    bottom: 0; left: 0; right: 0;
    background: linear-gradient(to bottom, rgba(246,247,249,0), var(--bg) 40%);
    border-top: 1px solid var(--border);
    padding: 12px 16px 18px;
  }
  
  /* Input + send similar to ChatGPT */
  .composer-inner {
    display: grid;
    grid-template-columns: 1fr auto;
    gap: 8px;
    max-width: 900px; margin: 0 auto;
  }
  
  #user-input, /* our JS id */
  #userInput /* backward compat */ {
    resize: none;
    min-height: 44px;
    max-height: 160px;
    padding: 12px 14px;
    border-radius: 14px;
    border: 1px solid var(--border);
    outline: none;
    background: var(--panel);
    font-size: 15px;
  }
  #user-input:focus { border-color: #b8bec6; }
  
  #send-button, /* our JS id */
  #sendButton /* backward compat */ {
    padding: 12px 16px;
    border-radius: 12px;
    border: 1px solid var(--border);
    background: var(--panel);
    cursor: pointer;
    font-weight: 600;
  }
  #send-button:hover { filter: brightness(0.98); }
  
  /* A small response area (if you still show the latest reply separately) */
  #response { display: none; }
  
  /* Mobile tweaks */
  @media (max-width: 520px) {
    #chat-container { max-width: 100%; }
    .chat-bubble { max-width: 88%; }
  }
  